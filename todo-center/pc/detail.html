<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>工单详情 - 待办中心</title>
    <link rel="stylesheet" href="css/pc.css">
</head>
<body>
    <!-- 全局导航栏 -->
    <nav class="top-navbar">
        <div class="nav-left">
            <div class="logo">
                <img src="../assets/logo.png" alt="中国华夏" class="logo-img">
                <span class="site-name">一站式门户</span>
            </div>
        </div>
        <div class="nav-right">
            <div class="user-info">
                <span class="username">用户名</span>
                <img src="../assets/avatar.png" alt="用户头像" class="avatar">
            </div>
        </div>
    </nav>

    <div class="main-container">
        <!-- 
            注释：三栏式布局
            - 整体为垂直三栏式布局
            - 第一栏为全局的菜单
            - 第二栏为工单列表
            - 第三栏为工单表单详情
            - 从列表中哪个工单点击进去，在表单详情页则定位到哪个工单
        -->
        
        <!-- 第一栏：左侧菜单 -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="workspace-title">
                    <span class="icon">🏠</span>
                    <span>工作台</span>
                </div>
            </div>
            <ul class="menu-list">
                <li class="menu-item">
                    <span class="menu-icon">💬</span>
                    <span class="menu-text">即时通讯</span>
                </li>
                <li class="menu-item">
                    <span class="menu-icon">🤖</span>
                    <span class="menu-text">AI助理</span>
                </li>
                <li class="menu-item">
                    <span class="menu-icon">📊</span>
                    <span class="menu-text">多维表格</span>
                </li>
                <li class="menu-item">
                    <span class="menu-icon">📦</span>
                    <span class="menu-text">应用管理</span>
                </li>
            </ul>
        </aside>

        <!-- 第二栏：工单列表 -->
        <div class="order-list-panel">
            <div class="list-header">
                <input type="text" class="search-input" placeholder="搜索标题、工单号、发起人...">
                <button class="search-btn">🔍</button>
            </div>
            <div class="order-list">
                <div class="order-item active" data-id="WO20250816001">
                    <div class="item-header">
                        <span class="order-id"># WO20250816001</span>
                        <span class="priority-badge urgent">紧急</span>
                    </div>
                    <div class="item-title">2026年年度预算申请</div>
                    <div class="item-meta">
                        <span class="initiator">周明俊</span>
                        <span class="time">2023-08-16 14:25:36</span>
                    </div>
                </div>

                <div class="order-item" data-id="WO20250816002">
                    <div class="item-header">
                        <span class="order-id"># WO20250816002</span>
                    </div>
                    <div class="item-title">AI智能客服系统项目立项审批</div>
                    <div class="item-meta">
                        <span class="initiator">张宁</span>
                        <span class="time">2023-08-16 14:25:36</span>
                    </div>
                </div>

                <div class="order-item" data-id="WO20250816003">
                    <div class="item-header">
                        <span class="order-id"># WO20250816003</span>
                    </div>
                    <div class="item-title">新员工入职审批</div>
                    <div class="item-meta">
                        <span class="initiator">陈鸿飞</span>
                        <span class="time">2023-08-16 14:25:36</span>
                    </div>
                </div>

                <div class="order-item" data-id="WO20250816004">
                    <div class="item-header">
                        <span class="order-id"># WO20250816004</span>
                    </div>
                    <div class="item-title">财务部软件采购合同审批</div>
                    <div class="item-meta">
                        <span class="initiator">刘明涛</span>
                        <span class="time">2023-08-16 14:25:36</span>
                    </div>
                </div>

                <div class="order-item" data-id="WO20250816005">
                    <div class="item-header">
                        <span class="order-id"># WO20250816005</span>
                    </div>
                    <div class="item-title">工程部自动化项目事宜讨论</div>
                    <div class="item-meta">
                        <span class="initiator">史进</span>
                        <span class="time">2023-08-16 14:25:36</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- 第三栏：表单详情 -->
        <div class="detail-panel">
            <!-- 面包屑导航 -->
            <!-- 注释：可快速跳转回工作台，适用于整个待办中心的所有页面 -->
            <div class="breadcrumb">
                <span class="breadcrumb-item clickable" onclick="location.href='index.html'">工作台</span>
                <span class="breadcrumb-separator">></span>
                <span class="breadcrumb-item">待办中心</span>
            </div>

            <div class="detail-content">
                <!-- 返回按钮 -->
                <div class="back-nav">
                    <button class="back-btn" onclick="history.back()"><< 返回待办列表</button>
                </div>

                <!-- 标题和标签 -->
                <div class="detail-header">
                    <span class="priority-tag urgent">紧急</span>
                    <h2 class="detail-title">2026年年度预算申请</h2>
                </div>

                <!-- 
                    注释：稍后办功能
                    - 对于当下无法做出审批决定的，可以点击【稍后办】
                    - 该工单的紧急程度自动标记为"稍后办"，且该工单自动置顶作为最高优先级
                    - 若有多个稍后办，则按标记稍后办的时间降序排序
                    - 若该工单本身就是紧急状态，两个状态均需展示
                -->
                <div class="detail-actions">
                    <button class="later-btn" onclick="markAsLater()">
                        <span>稍后办</span>
                        <span class="star-icon">⭐</span>
                    </button>
                </div>

                <!-- 基本信息 -->
                <section class="info-section">
                    <h3 class="section-title">基本信息</h3>
                    <div class="info-grid">
                        <div class="info-row">
                            <label>工单编号</label>
                            <span>WO20250816001</span>
                        </div>
                        <div class="info-row">
                            <label>工单来源</label>
                            <span>财务系统</span>
                        </div>
                        <div class="info-row">
                            <label>发起人</label>
                            <span>周明俊</span>
                        </div>
                        <div class="info-row">
                            <label>发起人部门</label>
                            <span>财务部</span>
                        </div>
                        <div class="info-row">
                            <label>发起时间</label>
                            <span>2023-08-16 14:25:36</span>
                        </div>
                        <div class="info-row">
                            <label>到达时间</label>
                            <span>2023-08-16 18:25:09</span>
                        </div>
                    </div>
                    <div class="description-box">
                        <label>工单描述</label>
                        <p>基于2025年实际收入增长15%的预测，考虑新产品发布和市场扩张计划。</p>
                    </div>
                </section>

                <!-- 审批流程 -->
                <section class="info-section">
                    <h3 class="section-title">审批流程</h3>
                    <div class="process-timeline">
                        <div class="process-node completed">
                            <div class="node-marker">
                                <span class="node-number">1</span>
                            </div>
                            <div class="node-content">
                                <div class="node-title">提交申请</div>
                                <div class="node-desc">申请人：周明俊（财务部）| 2023-08-16 14:25:36</div>
                                <div class="node-status completed-status">已完成</div>
                            </div>
                        </div>

                        <div class="process-node completed">
                            <div class="node-marker">
                                <span class="node-number">2</span>
                            </div>
                            <div class="node-content">
                                <div class="node-title">部门经理审批</div>
                                <div class="node-desc">审批人：张天一（财务部）| 2023-08-16 19:14:02</div>
                                <div class="node-status completed-status">已完成</div>
                                <div class="approval-comment">规划合理，批准</div>
                            </div>
                        </div>

                        <div class="process-node current">
                            <div class="node-marker">
                                <span class="node-number">3</span>
                            </div>
                            <div class="node-content">
                                <div class="node-title">财务审批</div>
                                <div class="node-desc">审批人：李天池（财务部）| 等待审批...</div>
                                <div class="node-status current-status">审批中</div>
                            </div>
                        </div>

                        <div class="process-node">
                            <div class="node-marker">
                                <span class="node-number">4</span>
                            </div>
                            <div class="node-content">
                                <div class="node-title">CFO审批</div>
                                <div class="node-desc">审批人：刘文（财务部）</div>
                                <div class="node-status pending-status">未开始</div>
                            </div>
                        </div>

                        <div class="process-node">
                            <div class="node-marker">
                                <span class="node-number">5</span>
                            </div>
                            <div class="node-content">
                                <div class="node-title">CEO审批</div>
                                <div class="node-desc">审批人：代柯（总裁办）</div>
                                <div class="node-status pending-status">未开始</div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- 附件信息 -->
                <section class="info-section">
                    <h3 class="section-title">附件</h3>
                    <div class="attachments">
                        <div class="attachment-item">
                            <span class="file-icon">📄</span>
                            <span class="file-name">2026年年度预算申请表.xlsx</span>
                            <button class="download-btn">下载</button>
                        </div>
                        <div class="attachment-item">
                            <span class="file-icon">📄</span>
                            <span class="file-name">市场可研报告.docx</span>
                            <button class="download-btn">下载</button>
                        </div>
                        <div class="attachment-item">
                            <span class="file-icon">📄</span>
                            <span class="file-name">2025年财报、利润表.rar</span>
                            <button class="download-btn">下载</button>
                        </div>
                    </div>
                </section>

                <!-- 审批意见 -->
                <section class="info-section" id="approvalSection">
                    <h3 class="section-title">审批意见</h3>
                    <textarea class="approval-textarea" placeholder="（选填）"></textarea>
                    <div class="approval-buttons">
                        <button class="approve-btn" onclick="handleApproval('approve')">
                            <span class="btn-icon">✓</span>
                            <span>同意</span>
                        </button>
                        <button class="reject-btn" onclick="handleApproval('reject')">
                            <span class="btn-icon">✗</span>
                            <span>拒绝</span>
                        </button>
                    </div>
                </section>

                <!-- 
                    注释：审批完成后的自动跳转
                    - 该工单完成审批后（同意或拒绝），自动跳转到下一条工单
                    - 上一条工单消失、自动归入已办列表
                -->
            </div>
        </div>
    </div>

    <script src="js/pc.js"></script>
    <script src="js/detail.js"></script>
</body>
</html>

